<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spin Wheel Name Picker</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <style>
        /* Default size for 1998x1080 screens */
        :root {
            --base-width: 100vw;
            --base-height: 100vh;
            --padding: 20px;
            --textarea-height: 300px;
            --textarea-max-width: 300px;
            --pointer-size: 50px;
            --pointer-offset: 10px;
            --font-size-base: 16px;
            --h1-margin-bottom: 20px;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-image: url('13.jpg'); /* Customizable background image URL */
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: var(--base-width);
            min-height: var(--base-height);
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        

        /* wrapper for our app content (avoid clashing with Bootstrap .container) */
        .app-container {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            padding: var(--padding);
            box-sizing: border-box;
            max-width: 1998px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin: 0 0 var(--h1-margin-bottom) 0;
            flex-shrink: 0;
            font-size: clamp(1.5rem, 4vw, 2.5rem);
        }

        .content {
            display: flex;
            flex: 1;
            gap: var(--padding);
            width: 100%;
            flex-wrap: wrap;
        }

        .left-panel {
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .right-panel {
            flex: 1;
            min-width: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        #wheel {
            width: 100%;
            max-width: 600px;
            aspect-ratio: 1;
            border-radius: 50%;
            position: relative;
            margin: 0;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        #centerImage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30%;
            height: 30%;
            border-radius: 50%;
            object-fit: cover;
        }

        #pointer {
            position: absolute;
            top: 50%;
            right: calc(var(--pointer-offset) * -1);
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: calc(var(--pointer-size) / 2) solid transparent;
            border-bottom: calc(var(--pointer-size) / 2) solid transparent;
            border-right: var(--pointer-size) solid #ff0000;
        }

        textarea {
            width: 100%;
            height: var(--textarea-height);
            max-width: var(--textarea-max-width);
            opacity: 0.8;
            border: 0;
            border-radius: 2%;
            margin: 10px 0;
            font-size: var(--font-size-base);
            padding: 10px;
        }

        #spinBtn {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30%;
            aspect-ratio: 1;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 0;
            cursor: pointer;
            z-index: 10;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            opacity: 0;
        }

        button {
            padding: 10px 20px;
            font-size: var(--font-size-base);
            cursor: pointer;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            max-width: 90%;
        }

        .modal button {
            margin: 10px;
        }

        /* Tablet screens (768px to 1024px) */
        @media (max-width: 1024px) {
            :root {
                --padding: 15px;
                --textarea-height: 250px;
                --textarea-max-width: 250px;
                --h1-margin-bottom: 15px;
            }

            #wheel {
                max-width: 400px;
            }

            .content {
                gap: 15px;
            }
        }

        /* Tablet screens (landscape) */
        @media (max-width: 1024px) and (orientation: landscape) {
            :root {
                --padding: 10px;
                --textarea-height: 200px;
                --textarea-max-width: 200px;
            }

            h1 {
                margin: 0 0 10px 0;
            }

            .content {
                gap: 10px;
            }
        }

        /* Small tablet or large phone (480px to 768px) */
        @media (max-width: 768px) {
            :root {
                --padding: 12px;
                --textarea-height: 200px;
                --textarea-max-width: 90%;
                --h1-margin-bottom: 12px;
            }

            .app-container {
                padding: var(--padding);
            }

            h1 {
                font-size: clamp(1.2rem, 3.5vw, 2rem);
            }

            .content {
                flex-direction: column;
                gap: 12px;
            }

            .left-panel {
                width: 100%;
                min-width: unset;
            }

            .right-panel {
                width: 100%;
                min-width: unset;
            }

            #wheel {
                max-width: 350px;
                width: 95%;
            }

            textarea {
                max-width: var(--textarea-max-width);
                height: var(--textarea-height);
            }

            button {
                font-size: 14px;
                padding: 8px 16px;
            }
        }

        /* Smartphone portrait (320px to 480px) */
        @media (max-width: 480px) {
            :root {
                --padding: 8px;
                --textarea-height: 150px;
                --textarea-max-width: 95%;
                --h1-margin-bottom: 8px;
                --pointer-size: 15px;
                --pointer-offset: 8px;
            }

            .app-container {
                padding: var(--padding);
            }

            h1 {
                font-size: clamp(1rem, 3vw, 1.5rem);
                margin: 0 0 8px 0;
            }

            .content {
                flex-direction: column;
                gap: 8px;
            }

            .left-panel {
                width: 100%;
            }

            .right-panel {
                width: 100%;
            }

            #wheel {
                max-width: 280px;
                width: 100%;
            }

            #centerImage {
                width: 25%;
                height: 25%;
            }

            textarea {
                max-width: var(--textarea-max-width);
                height: var(--textarea-height);
                font-size: 14px;
            }

            button {
                font-size: 13px;
                padding: 6px 12px;
            }

            .modal-content {
                padding: 15px;
                font-size: 14px;
            }
        }

        /* Large desktop screens (1920px and above) */
        @media (min-width: 1920px) {
            :root {
                --padding: 25px;
                --textarea-height: 350px;
                --textarea-max-width: 350px;
                --h1-margin-bottom: 25px;
            }

            #wheel {
                max-width: 600px;
            }

            h1 {
                font-size: 2.5rem;
            }
        }

        /* Extra large screens (2560px and above) */
        @media (min-width: 2560px) {
            :root {
                --padding: 30px;
                --textarea-height: 400px;
                --textarea-max-width: 400px;
                --h1-margin-bottom: 30px;
            }

            #wheel {
                max-width: 700px;
            }

            h1 {
                font-size: 3rem;
            }

            textarea {
                font-size: 18px;
            }

            button {
                font-size: 18px;
                padding: 12px 24px;
            }
        }
    </style>
</head>
<body>

    
   
    <nav class="navbar navbar-light bg-transparent row" >
        <div class="col container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    

    <div class="app-container container-fluid d-flex flex-column vh-100 p-3">
        <!-- Logo image at the top - replace src with your logo image URL -->
        <div class="content row flex-grow-1">
            <div class="right-panel col-12 col-md-6 d-flex justify-content-center align-items-center">
                <div id="wheel" class="position-relative d-flex justify-content-center align-items-center">
                    <canvas id="wheelCanvas"></canvas>
                    <img id="centerImage" src="https://via.placeholder.com/50.jpg" alt="Center Image"> <!-- Customizable center image - replace src with your JPG or PNG image URL -->
                    <div id="pointer"></div>
                    <button id="spinBtn" class="btn btn-primary">Spin</button>
                </div>
            </div>
        </div>
    </div>


    <div class="collapse position-absolute top-50 start-50 translate-middle" id="navbarToggleExternalContent">
        <div class="bg-dark p-4">
            <div class="left-panel col-12 col-md-6 d-flex flex-column justify-content-center align-items-start rounded">
                <label for="names" class="form-label visually-hidden">Nama</label>
                <textarea id="names" class="form-control" placeholder="Masukkan nama-nama, pisahkan dengan baris baru atau koma"></textarea>
            </div>
        </div>
    </div>

    <!-- Bootstrap Modal -->
    <div class="modal fade" id="resultModal" tabindex="-1" aria-labelledby="resultModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center">
                    <p id="resultText"></p>
                </div>
                <div class="modal-footer justify-content-center">
                    <button id="removeBtn" type="button" class="btn btn-danger">Hapus Nama (x)</button>
                    <button id="continueBtn" type="button" class="btn btn-secondary" data-bs-dismiss="modal">Lanjutkan Spin (c)</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Function to create custom wheel image
        function createCustomWheelImage() {
            const canvas = document.createElement('canvas');
            canvas.width = 300;
            canvas.height = 300;
            const ctx = canvas.getContext('2d');
            
            // Draw background circle
            ctx.fillStyle = '#FFCE00';
            ctx.beginPath();
            ctx.arc(150, 150, 150, 0, 2 * Math.PI);
            ctx.fill();
            
            // Draw border circle
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(150, 150, 150, 0, 2 * Math.PI);
            ctx.stroke();
            
            return canvas.toDataURL();
        }

        // Customizable variables - change these to customize the wheel
        const customization = {
            wheelColors: ['#0093AE', '#172858'], // Array of colors for wheel segments
            pointerColor: '#ff0000', // Color of the pointer
            backgroundColor: '#f0f0f0', // Background color of the page
            wheelImage: createCustomWheelImage(), // Wheel background image URL (generated dynamically)
            centerImageSrc: 'kepalaconi.jpg', // Center image URL (JPG or PNG)
            pointerShape: 'triangle-right' // Options: 'triangle-right', 'triangle-down', etc. (for future expansion)
        };

        // Apply customizations
        document.body.style.backgroundColor = customization.backgroundColor;
        document.getElementById('wheel').style.backgroundImage = `url('${customization.wheelImage}')`;
        document.getElementById('pointer').style.borderRightColor = customization.pointerColor;
        document.getElementById('centerImage').src = customization.centerImageSrc;
        // Add some Bootstrap-adaptive classes (if needed)
        document.getElementById('names').classList.add('form-control');

        const wheelElement = document.getElementById('wheel');
        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const namesTextarea = document.getElementById('names');
        const spinBtn = document.getElementById('spinBtn');
        const modalElement = document.getElementById('resultModal');
        let bootstrapModal = null; // will be created lazily when showing
        const resultText = document.getElementById('resultText');
        const removeBtn = document.getElementById('removeBtn');
        const continueBtn = document.getElementById('continueBtn');

        let names = [];
        let isSpinning = false;
        let selectedName = '';

        // Function to resize canvas
        function resizeCanvas() {
            const size = wheelElement.offsetWidth;
            canvas.width = size;
            canvas.height = size;
            drawWheel();
        }

        // Resize canvas on window resize
        window.addEventListener('resize', resizeCanvas);
        // Initial resize
        setTimeout(resizeCanvas, 0);

        function drawWheel() {
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = canvas.width / 2 * 0.9; // 90% of canvas size
            const anglePerSegment = (2 * Math.PI) / names.length;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            names.forEach((name, index) => {
                const startAngle = index * anglePerSegment;
                const endAngle = (index + 1) * anglePerSegment;

                // Draw segment
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.closePath();
                ctx.fillStyle = customization.wheelColors[index % customization.wheelColors.length];
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.stroke();

                // Draw text (positioned closer to center to avoid overflow)
                const textAngle = startAngle + anglePerSegment / 2;
                const textRadius = radius * 0.7; // move text closer to center (60% of radius)
                const textX = centerX + Math.cos(textAngle) * textRadius;
                const textY = centerY + Math.sin(textAngle) * textRadius;
                ctx.save();
                ctx.translate(textX, textY);
                ctx.rotate(textAngle);
                ctx.fillStyle = '#fff';
                // Adaptive font: base size scaled to canvas, shrink if name is long to stay within segment
                const baseFont = canvas.width * 0.040; // reduced base font size
                const fontSize = Math.max(8, Math.min(baseFont, baseFont - name.length * 0.8)); // more aggressive shrinking
                ctx.font = `${fontSize}px Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(name, 0, 0);
                ctx.restore();
            });
        }

        function spinWheel() {
            if (isSpinning || names.length === 0) return;
            isSpinning = true;

            // Tambahkan musik saat spinWheel aktif
            const audio = new Audio('contoh.mp3');
            audio.play();

            const spinDuration = 3000; // Duration in ms
            const spinAngle = Math.random() * 360 + 720; // Random angle + multiple rotations
            const startTime = Date.now();

            function animate() {
                const elapsed = Date.now() - startTime;
                const progress = elapsed / spinDuration;
                const easeOut = 1 - Math.pow(1 - progress, 3); // Easing function
                const currentAngle = spinAngle * easeOut;

                ctx.save();
                ctx.translate(canvas.width / 2, canvas.height / 2);
                ctx.rotate((currentAngle * Math.PI) / 180);
                ctx.translate(-canvas.width / 2, -canvas.height / 2);
                drawWheel();
                ctx.restore();

                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    isSpinning = false;
                    // Hentikan musik saat animasi selesai (opsional, jika ingin musik berhenti)
                    audio.pause();
                    // Calculate selected name based on final angle
                    const finalAngle = (spinAngle % 360) * (Math.PI / 180);
                    const segmentAngle = (2 * Math.PI) / names.length;
                    const selectedIndex = Math.floor((2 * Math.PI - finalAngle) / segmentAngle) % names.length;
                    selectedName = names[selectedIndex];
                    showResult();
                }
            }
            animate();
        }


        function showResult() {
            resultText.textContent = `Selamat anda menang ${selectedName}`;
            // create bootstrap modal instance lazily (bootstrap script is loaded after this script)
// Tambahkan musik saat showResult aktif
            const audio = new Audio('contoh2.mp3');
            audio.play();

            if (!bootstrapModal && typeof bootstrap !== 'undefined') {
                bootstrapModal = new bootstrap.Modal(modalElement);
            }
            if (bootstrapModal) {
                bootstrapModal.show();
            } else {
                // Fallback: make modal visible if bootstrap isn't available
                modalElement.style.display = 'flex';
            }
        }



        function hideModal() {
            if (bootstrapModal) {
                bootstrapModal.hide();
            } else {
                modalElement.style.display = 'none';
            }
        }

        removeBtn.addEventListener('click', () => {
            names = names.filter(name => name !== selectedName);
            namesTextarea.value = names.join('\n');
            drawWheel();
            hideModal();
        });

        continueBtn.addEventListener('click', () => {
            hideModal();
        });

        spinBtn.addEventListener('click', () => {
            const input = namesTextarea.value;
            names = input.split(/[\n,]+/).map(name => name.trim()).filter(name => name);
            if (names.length > 0) {
                drawWheel();
                spinWheel();
            }
        });

        // Initial draw if names are present
        namesTextarea.addEventListener('input', () => {
            const input = namesTextarea.value;
            names = input.split(/[\n,]+/).map(name => name.trim()).filter(name => name);
            drawWheel();
        });

        // Hotkey: Press 'Z' to spin the wheel
        document.addEventListener('keydown', (event) => {
            if (event.key.toLowerCase() === 'z') {
                event.preventDefault(); // prevent default behavior
                // trigger spin button click
                spinBtn.click();
            }
        });

        // Hotkey: Press 'X' to remove name from list
        document.addEventListener('keydown', (event) => {
            if (event.key.toLowerCase() === 'x') {
                event.preventDefault();
                removeBtn.click();
            }
        });

        // Hotkey: Press 'Y' to continue spin
        document.addEventListener('keydown', (event) => {
            if (event.key.toLowerCase() === 'c') {
                event.preventDefault();
                continueBtn.click();
            }
        });
    </script>
    <!-- Bootstrap 5 JS bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</body>
</html>
